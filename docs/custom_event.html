<!DOCTYPE html>
<html>
  <head>
    <title>custom_event.js</title>
    <link rel="stylesheet" href="http://yandex.st/highlightjs/6.0/styles/github.min.css">
    <style>
      /* {{{ */
      body {
        margin: 50px 50px 80px 50px;
      }
      body, a {
        font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
        font-height: 16px;
        line-height: 24px;
        color: black;
      }
      section {
        width: 720px;
      }
      #introduction, #functions, #ListenerObject, #changelog {
        margin-top: 2.5em;
      }
      h1 { font-size: 2em; font-weight: bold; }
      h2 { font-size: 1.5em; font-weight: bold; }
      h3 { 
        font-size: 16px; 
        font-weight: bold; 
        line-height: 24px;
        margin-bottom: 0;
      }
      h1,h2,h3 {
        color: #204060;
      }
      h4 {
        font-size: 14px;
        font-family: Monospace;
        font-weight: normal;
        color: #333;
      }
      a, a:visited {
        background-color: #eaeaea;
        color: black;
        text-decoration: none;
        cursor: pointer;
        padding: 1px 3px;
        border-radius: 2px;
      }
      a:hover {
        background-color: #303030;
        color: white;
        text-decoration: underline;
      }
      dt {
        font-weight: bold;
      }
      #contents ul {
        list-style-type: none;
        padding-left: 0;
        margin-top: 0;
      }
      #contents ul > li {
        display: inline-block;
      }
      #functions hgroup > h3 {
        display: inline-block;
      }
      #functions hgroup > h4 {
        display: inline-block;
        margin-left: 2em;
        margin-bottom: 0;
      }
      pre > code {
        line-height: 16px;
        border-radius: 3px;
        padding: 0 0.5em;
        border: 1px solid #c0d0e0;
      }
      /* }}} */
    </style>
  </head>
  <body>
    <h1>custom_event.js</h1>

    <section id="description">
      <p>
        CustomEvent is a library for progamming JavaScript in an event-driven manner.
      </p>
    </section>

    <section id="contents">
      <header>
        <h2>Table Of Contents</h2>
      </header>

      <article>
        <ul>
          <li><a href="#intro">Introduction</a></li>
        </ul>
      </article>

      <article>
        <h3>Functions</h3>
        <ul>
          <li><a href="#_E_on">_E.on</a></li>
          <li><a href="#_E_once">_E.once</a></li>
          <li><a href="#_E_unbind">_E.unbind</a></li>
          <li><a href="#_E_emit">_E.emit</a></li>
          <li><a href="#_E_connect">_E.connect</a></li>
        </ul>
      </article>

      <article>
        <h3>ListenerObject</h3>
        <ul>
          <li><a href="#_emit">emit</a></li>
          <li><a href="#_unbind">unbind</a></li>
          <li><a href="#_pause">pause</a></li>
        </ul>
      </article>

      <article>
        <h3>Evented Modules</h3>
        <ul>
          <li><a href="#_E_Module">_E.Module</a></li>
        </ul>
      </article>

      <article>
        <h3>ModuleObject</h3>
        <ul>
          <li><a href="#_emit">destroy</a></li>
          <li><a href="#_pause">pause</a></li>
        </ul>
      </article>

      <article>
        <ul>
          <li><a href="#changelog">CHANGELOG</a></li>
        </ul>
      </article>
    </section>

    <section id="introduction">
      <h2>Introduction</h2>
      <p>
        Bla, foo. Namespace is <code>_E</code>.
      </p>
    </section>

    <section id="functions">
      <h2>Functions</h2>

      <article id="_E_on">
        <hgroup>
          <h3>_E.on</h3>
          <h4>_E.on(action, callback_fn, [options])</h4>
        </hgroup>
        <p>
          Register an event listener for given <em>action</em>.<br/>
          Returns a <a href="#ListenerObject">ListenerObject</a>.
        </p>
        <pre><code>
_E.on("hello/world", function() { console.log(this.name.replace(/\//g, " ")); });

// with arguments
_E.on("foo/bar", function(x, y) { console.log("x=", x, "y=", y); });
        </code></pre>
      </article>

      <article id="_E_once">
        <hgroup>
          <h3>_E.once</h3>
          <h4>_E.once(action, callback_fn, [options])</h4>
        </hgroup>
        <p>
          Register an event listener for given <em>action</em>.
          This has the same behaviour as <a href="#_E_on">_E.on</a> with a single exception:
          after <em>action</em> is triggered and function <em>callback_fn</em> is called,
          the listener will be automatically unbound.<br/>
          Returns a <a href="#ListenerObject">ListenerObject</a>.
        </p>
        <pre><code>
_E.once("foo/bar", function() { console.log("you'll never see this message again!"); })
        </code></pre>
      </article>

      <article id="_E_unbind">
        <hgroup>
          <h3>_E.unbind</h3>
          <h4>_E.unbind(listener_id)</h4>
        </hgroup>
        <p>
          Unregister an event listener.
        </p>
        <pre><code>
var listener = _E.on("foo/bar", function() { console.log("plah!"); });

// .. do your awesome business now ..

listener.unbind();
        </code></pre>
      </article>

      <article id="_E_emit">
        <hgroup>
          <h3>_E.emit</h3>
          <h4>_E.emit(action, [args, ..])</h4>
        </hgroup>
        <p>
          Trigger the event <em>action</em>.<br/>
          Use <em>args</em> as you like. All <em>args</em> will be forwarded to all listener functions (if any).<br/>
          If last given argument is a function, it will be used as <em>result function</em>
          and called immediately after all listeners.
        </p>
        <pre><code>
_E.emit("hello/world");      // =&gt; "hello world"

// with arguments
_E.emit("/foo/bar", 1, 2);   // =&gt; "x= 1, y= 2"
        </code></pre>
      </article>

      <article id="_E_connect">
        <hgroup>
          <h3>_E.connect</h3>
          <h4>_E.connect(action, trigger_action, [trigger_action, ..])</h4>
        </hgroup>
        <p>
          Register the event <em>action</em>.
          After someone triggered <em>action</em>, all given <em>trigger_actions</em> will be immediately emitted as events.<br/>
          Give many <em>trigger_actions</em> as you like.<br/>
          With this function you can <em>connect</em> one action with other actions,
          without the need to register function callbacks at the time you create such a connection.<br/>
          Returns a <a href="#ListenerObject">ListenerObject</a>.
        </p>
      </article>
        <pre><code>
_E.connect("make/world", "hello/world", "foo/bar", "one/more/event");
        </code></pre>
    </section>

    <section id="ListenerObject">
      <h2>ListenerObject</h2>
      <p>
        After registering a <a href="#_E_on">callback function</a> or <a href="#_E_connect">connecting actions</a> you will get a <em>ListenerObject</em> as result.<br/>
        This object provides you with infos and some (hopefully) useful methods for the listener.<br/>
      </p>

      <h3>Attributes</h3>
      <dl>
        <dt>id</dt>
        <dd>Unique listener id.</dd>

        <dt>name</dt>
        <dd>Event <em>action</em> name.</dd>
      </dl>
      
      <h3>Methods</h3>
      <dl>
        <dt>emit</dt>
        <dd><code>emit([args, ..])</code></dd>
        <dd>Trigger the <em>action</em> &rarr; <code><em>listener</em>.name</code> instantly.</dd>

        <dt>unbind</dt>
        <dd><code>unbind()</code></dd>
        <dd>Alias for <code>_E.unbind(<em>listener</em>.id)</code>.</dd>

        <dt>pause</dt>
        <dd><code>pause([pause])</code></dd>
        <dd><em>Pause</em> the callback function temporary. If you set <em>pause</em> to <code>true</code>,
          next time <em>action</em> &rarr; <code><em>listener</em>.name</code> is triggered, the listener will NOT be invoked.<br/>
          Setting <em>pause</em> to <code>false</code> will enable the listener again.<br/>
          Returns the current <em>pause</em> state if called without argument.</dd>
      </dl>
      
    </section>

    <section id="_E_Module">
      <h2>Evented Modules</h2>
      <p>
        <em>TODO</em> introduction
      </p>

      <h3>Example</h3>
      <pre><code>
fooMod = _E.Module("/foo/mod", {
    
    // constructor [optional]
    _init: function() { 
        console.log("_init", this); 
        this.a = 11; 
    },

    'on foo': function() { console.log("/foo/mod/foo"); },
    'on bar': function(x, y) { console.log("/foo/mod/bar", x, y); },

    'on hello ..': function(forename, lastname) {
      console.log('/foo/mod/hello/' + forename + '/' + lastname, arguments);
    },

    'on a': function(n) { 
        var b = this.a;
        console.log("/foo/mod/a", "a", b, "-&gt;", n);
        this.a = n;
        return b;
    },

    'module sub': {
        'on plah': function() { console.log("/foo/mod/sub/plah", arguments); }
    }
});
      </code></pre>

      <h3>Module Methods</h3>
      <dl>
        <dt>destroy</dt>
        <dd><code>destroy()</code></dd>
        <dd>Unbind all listeners for this module.</dd>

        <dt>pause</dt>
        <dd><code>pause([pause])</code></dd>
        <dd><em>Pause</em> the callback function temporary. If you set <em>pause</em> to <code>true</code>,
          none of the listeners registered by this module will NOT be invoked.<br/>
          Setting <em>pause</em> to <code>false</code> will enable the module again.<br/>
          Returns the current <em>pause</em> state if called without argument.</dd>
      </dl>
    </section>

    <section id="changelog">
      <h2>CHANGELOG</h2>

      <dl>
        <dt>0.6.4</dt>
        <dd>2011-07-28</dd>
        <dd>Added event path arguments listener syntax, like <code>'on foo ..'</code> for modules.</dd>
      </dl>
    </section>

    <script src="http://yandex.st/highlightjs/6.0/highlight.min.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <script src="modernizr.js"></script>
    <script>
      Modernizr.load([
        {
          load: "custom_event.js",
          complete: function() {
            _E.options.debug = true;
          }
        }
      ]);
    </script>
  </body>
</html>
